# tbm
Shield machine travel data regression analysis and input parameter optimization.

Use different visualization methods and different models for analysis.

**just for fun**

# install
just type command as follows:
1. make sure you have download git lfs
```python
git lfs install
```
........

# 统计信息

## Cutter_layout_template.xlsx

该表记录 41 把滚刀的物理参数和布局关系，无缺失值。

![image-20250829205912570](C:\Users\miaohan\AppData\Roaming\Typora\typora-user-images\image-20250829205912570.png)

## geologic_parameter.xlsx

按掘进段记录地质特征，是模型的输入参数。

![image-20250829210620966](C:\Users\miaohan\AppData\Roaming\Typora\typora-user-images\image-20250829210620966.png)

| 原表头       | 合并后表头    | 含义解释                                          |
| ------------ | ------------- | ------------------------------------------------- |
| segment_id   | segment_id    | 掘进段编号（1-327），标识每个 1.5m 左右的掘进区间 |
| UCS(MPa)     | ucs_mpa       | 单轴抗压强度                                      |
| CAI          | cai           | 岩芯可钻性指数                                    |
| BTS(MPa)     | bts_mpa       | 巴西劈裂抗拉强度                                  |
| des（g/mm²） | des_g_per_mm2 | 岩石的每平方毫米的密度                            |
| BQ           | bq            | 综合评价岩体稳定性的指标，值越大岩体质量越好      |

## **tunnel_data.xlsx**

记录掘进过程中的实时监测数据，需要按 1.5m 区间聚合后作为模型输入参数。

| 原表头                             | 合并后表头                                    | 含义解释                                     |
| ---------------------------------- | --------------------------------------------- | -------------------------------------------- |
| 掘进位移                           | tunneling_displacement                        | 盾构机推进的距离                             |
| 刀盘转速                           | cutter_head_speed_rpm                         | 刀盘旋转速度                                 |
| 主推进力                           | main_thrust_kn                                | 推动盾构机前进的主要力量                     |
| 扭矩压力                           | torque_pressure_bar                           | 刀盘扭矩对应的液压压力                       |
| 刀盘扭矩                           | cutter_head_torque_kNm                        | 刀盘旋转时的扭矩                             |
| 辅助夹持器压力                     | auxiliary_gripper_pressure_bar                | 辅助夹持器的液压压力                         |
| 辅助推进油缸 1~3                   | auxiliary_thrust_cylinder_1~3                 | 辅助推进油缸的压力或位移，辅助调整盾构机姿态 |
| 吸收泵 M1~M6 电流                  | absorption_pump_m1~m6_current                 | 吸收泵电机的电流                             |
| 油液湿度传感器                     | oil_humidity_sensor                           | 液压油的湿度检测值                           |
| 液压油位                           | hydraulic_oil_level                           | 液压油箱的油位高度，监测油液是否充足         |
| 润滑压力 PTX97_05~06、PTX_97_03    | lubrication_pressure_ptx97_05~06、ptx97_03    | 各润滑点的压力                               |
| 主推进油缸 1 和 10、2 和 3 等      | main_thrust_cylinder_1_10 等                  | 对应组合的主推进油缸压力                     |
| 主推进活塞杆 1、10                 | main_thrust_piston_rod_1、10                  | 主推进活塞杆的伸出长度                       |
| 闭路压水系统状态                   | closed_loop_water_system_status               | 闭路水循环系统的运行状态                     |
| 备用回转输送压力                   | backup_rotary_conveying_pressure              | 备用螺旋输送机的压力                         |
| 盾构机回转输送压力                 | tbm_rotary_conveying_pressure                 | 主螺旋输送机的压力，反映渣土输送的阻力       |
| 推进比例阀开度 - 下 / 左 / 右 / 上 | thrust_proportion_valve_bottom/left/right/top | 各方向推进比例阀的开度                       |
| 回油压力                           | return_oil_pressure                           | 液压系统回油的压力，反映油路阻力             |
| 滚动盾构夹持器状态                 | rolling_shield_gripper_status                 | 滚动盾构夹持器的工作状态（                   |
| 稳定器压力                         | stabilizer_pressure_bar                       | 稳定器的液压压力                             |
| 闭路水温                           | closed_loop_water_temperature                 | 闭路循环水的温度，反映冷却系统效率           |
| 扭矩电机 01~04、07                 | torque_motor_01~04、07                        | 驱动刀盘扭矩的电机状态                       |
| 推进速度 AR（mm/min）              | advance_speed_mm_per_min                      | 盾构机前进速度                               |

## wear_data.xlsx

| 原表头      | 合并后表头         | 含义解释            |
| ----------- | ------------------ | ------------------- |
| 掘进段      | segment_id         | 掘进段编号          |
| 掘进距离    | tunneling_distance | 该段的总掘进距离    |
| 能量        | energy             | 该段掘进消耗的比能  |
| cutter_1~41 | cutter_1~41_wear   | 1~41 号刀具的磨损量 |

# 数据合并

具体流程如下：

1. 加载所有文件，重命名所有表头
2. 处理磨损数据，计算每次掘进段的磨损差值，并处理换刀情况
3. 对掘进数据进行聚合，计算每个区间段的统计特征
4. 为地质数据添加距离信息
5. 按照`segment_id`和`tunneling_distance`合并地质数据和磨损数据
6. 合并聚合后的掘进参数数据
7. 将41把刀具的信息都合并进来。

# 数据探索

目标变量分布，分布非常好

![image-20250829215947212](C:\Users\miaohan\AppData\Roaming\Typora\typora-user-images\image-20250829215947212.png)

刀具磨损相关性分析，可以看出相关性非常非常高

![image-20250829215621003](C:\Users\miaohan\AppData\Roaming\Typora\typora-user-images\image-20250829215621003.png)



![image-20250829215723246](C:\Users\miaohan\AppData\Roaming\Typora\typora-user-images\image-20250829215723246.png)

地质参数与目标变量的关系：没啥关系



![image-20250829215759677](C:\Users\miaohan\AppData\Roaming\Typora\typora-user-images\image-20250829215759677.png)

操作参数与推进速度的关系

![image-20250829220004789](C:\Users\miaohan\AppData\Roaming\Typora\typora-user-images\image-20250829220004789.png)

更多的可视化在`tbm_visualizations`，这个数据太差了，非常非常乱。

# 特征工程

无缺失值，不需要采样，不需要增强

1. PCA
2. 去除多重共线性
3. 归一化

# 回归分析

### 机器学习

```
目标变量,最佳模型,R2分数,MSE,MAE
energy,K近邻,0.24091090374013957,1.481725265897394,0.9718990093612402
advance_speed_mm_per_min_mean,随机森林,0.995707889070249,0.661013413236119,0.4884757202653511
cutter_1_wear,随机森林,0.12620921909241567,7.351745453522458e-05,0.00621532297312128
cutter_2_wear,随机森林,0.11767389043492249,0.0001220841613375655,0.008138094379343439
cutter_3_wear,随机森林,0.25850984162990187,0.0001087676025252149,0.007901970653256925
cutter_4_wear,随机森林,0.14926067080522143,0.00014520440544701793,0.00902563082956597
cutter_5_wear,随机森林,0.10707054144876049,0.0001693507376316897,0.009568316913161588
cutter_6_wear,随机森林,0.08556849293835833,0.00017959527248286904,0.009892253449750482
cutter_7_wear,AdaBoost,0.050796633008068914,0.00019982137259307308,0.011191069522961146
cutter_8_wear,随机森林,0.03298113108191281,0.0002180281744989946,0.011391181418523945
cutter_9_wear,AdaBoost,0.02698327705570147,0.0002678970169041957,0.01322163287968733
cutter_10_wear,随机森林,0.11244297222078514,0.0002599024231364361,0.01233356310406105
cutter_11_wear,随机森林,0.016279710755693122,0.00030513366479031413,0.013062918284194902
cutter_12_wear,AdaBoost,0.07858339491779409,0.0003025686611084433,0.013916835959470958
cutter_13_wear,梯度提升,0.017107591486958174,0.0005206244656550692,0.01843286894908178
cutter_14_wear,随机森林,0.21270138023333496,0.00028914344583842207,0.01284169608242662
cutter_15_wear,AdaBoost,0.05359810157833844,0.00038585873573748075,0.015698099638036016
cutter_16_wear,AdaBoost,0.04946882828583876,0.0004158261823523338,0.01599186289366589
cutter_17_wear,随机森林,0.04506951184015795,0.00044293672015757366,0.015619477897040398
cutter_18_wear,梯度提升,-0.022311034861755452,0.0004709488038538481,0.017362751131172544
cutter_19_wear,随机森林,0.05680270490080597,0.0004483397488471627,0.017064933165822728
cutter_20_wear,随机森林,0.06250092488535164,0.0004172421231790565,0.01639029330344185
cutter_21_wear,随机森林,-0.01319436852038991,0.000525283932388948,0.018095187368986538
cutter_22_wear,随机森林,0.05623887234227787,0.0005284361743580878,0.01870258029637153
cutter_23_wear,随机森林,0.04091847038704777,0.0005367331640001107,0.01857768553862046
cutter_24_wear,随机森林,-0.012604493628869617,0.0006096921090442511,0.0195173697383959
cutter_25_wear,随机森林,-0.015511710893079345,0.0006473103910586149,0.020222223960233435
cutter_26_wear,随机森林,0.01507193149379249,0.0006338150231914129,0.019964621821832083
cutter_27_wear,随机森林,0.22726166878039866,0.0006208174544665393,0.019915477192942142
cutter_28_wear,梯度提升,0.015759910383917997,0.0006993730011300767,0.021016374936857325
cutter_29_wear,随机森林,0.029131135475483405,0.0008269224472092634,0.023102200216669335
cutter_30_wear,AdaBoost,0.03104867111943832,0.0008053726112932371,0.0217335082240824
cutter_31_wear,AdaBoost,0.2254502791085825,0.0010978988707162146,0.024879186471116196
cutter_32_wear,AdaBoost,0.09195529487407472,0.000803200661886233,0.022000650646279027
cutter_33_wear,随机森林,0.19604554268861152,0.0009721111729549013,0.023738015400334513
cutter_34_wear,随机森林,0.1841391859654823,0.0009191400435453283,0.022503707195811223
cutter_35_wear,随机森林,0.08861023472246932,0.0016687352834992182,0.028806291488213565
cutter_36_wear,梯度提升,0.15164010398707717,0.0014714347340606135,0.03088148913988557
cutter_37_wear,梯度提升,-0.06469370489376391,0.0030468838007116535,0.044371492000918215
cutter_38_wear,随机森林,0.14117941919864674,0.002842332786582858,0.041744974245149086
cutter_39_wear,梯度提升,0.04271411085740129,0.0033665305713600617,0.044838788727095596
cutter_40_wear,梯度提升,-0.0031702869146701396,0.003112837553705332,0.0433272952821298
cutter_41_wear,Ridge回归,0.006810689885194732,0.0030021476304507343,0.04176931478274375
```

# 优化

1. 新的数据需要替换成42把刀的数据，目前的数据不是全部的刀
2. 运行新的merge.py来合并数据
3. opt.py是优化，因为要搜索极大的参数空间，大概10h一次，我断断续续改了几十次代码。。。

